
<div class="container content-width mx-auto">
    
    <div class="row justify-content-center">
        <div class="col-sm-4">Name</div>
        <div class="col-sm-8">
            <%= @merchant.name %>
        </div>
    </div>
    
    <div class="row justify-content-center">
        <div class="col-sm-4">Website</div>
        <div class="col-sm-8">
            <%= link_to @merchant.website, @merchant.website %>
        </div>
    </div>
    
    <div class="row justify-content-center">
        <div class="col-sm-4">Phone Number</div>
        <div class="col-sm-8">
            <%=  @merchant.phone_number %>
        </div>
    </div>
    
    <div class="row justify-content-center">
        <div class="col-sm-4">Address</div>
        <div class="col-sm-8">
            <%=  @merchant.address %>
        </div>
    </div>
    
    <div class="row justify-content-left">
        <div class="col-sm-12">
            <% if @merchant.stripe_id %>
                <div class="stripe-dashboard-link btn btn-link" data-merchant-id="<%= @merchant.id %>" href="">Visit Stripe Dashboard</div>
            <% else %>
                <div class="stripe-connect btn btn-link" data-merchant-id="<%=@merchant.id %>" href=""><span>Connect Stripe Account</span></div>
            <% end %>
        </div>
    </div>
    
    <div class="row justify-content-left">
        <div class="col-sm-12">
            <a class="btn btn-link edit-merchant" href="<%= edit_merchant_url %>">Edit</a>
        </div>
    </div>
    
</div>

<%= form_for @merchant, url: {action: :update_products}, method: "post" do %>
<div class="container content-width products mt-5">
    <h5>Products</h5>
    <table class="table merchant-products">
          <thead>
            <th>Redeem?</th>
            <th class="text-left">Product</th>
            <th>Price</th>
        </thead>
        <tbody>
        <% @products.each do |p| %>
        <tr>
            <td width="10" class="text-center">
                <%= hidden_field "products[#{p.id}]", "id", {value: p.id}%>
                <%= check_box "products[#{p.id}]", "can_redeem", {checked: p.can_redeem?(@merchant), class: 'form-check-input product-redeem-checkbox'}, true, false %>
            </td>
            <td class="text-left">
                <%= p.name %>
            </td>
            <td>
                <%= number_to_currency(p.price(:dollars)) %>
            </td>
        </tr>
        <% end %>
        </tbody>
    </table>
    <div class="merchant-products-submit text-right" style="display: none">
        <%= submit_tag 'Save', {class: "btn btn-primary"}%>
    </div>
</div>
<% end # End of Form %> 

<div class="container content-width charges mt-5">
    <h5>Credits</h5>
    <table class="table">
        <tr>
            <th>Date</th>
            <th>Amount</th>
        </tr>
        <% @merchant.charges.each do |c| %>
        <tr>
            <td><%= c[:created_at].to_date.to_formatted_s(:short) %></td>
            <td><%= number_to_currency(c[:amount_cents]/100.0) %></td>
        </tr>
        <% end %>
    </table>
</div>